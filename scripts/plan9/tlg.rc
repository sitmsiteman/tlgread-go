#!/bin/rc

LYCROOT=/sys/lib/lyceum
TLGROOT=/sys/lib/lyceum/TLG-E
PHIROOT=/sys/lib/lyceum/PHI-5

GRLM=$LYCROOT/dependencies/greek-lemmata.txt
GRAN=$LYCROOT/depencencies/greek-analyses.txt
GRANIDT=$LYCROOT/depencencies/greek-analyses.idt
LSJ=$LYCROOT/depencencies/grc.lsj.xml
LSJIDT=$LYCROOT/depencencies/lsj.idt

LALM=$LYCROOT/depencencies/latin-lemmata.txt
LAAN=$LYCROOT/depencencies/latin-analyses.txt
LAANIDT=$LYCROOT/depencencies/latin-analyses.idt
LS=$LYCROOT/depencencies/lat.ls.perseus-eng1.xml
LSIDT=$LYCROOT/depencencies/ls.idt


fn usage{
	echo 'l [tlg,phi]'
	echo '	print authtab.dir infos'
	echo 'tl tlgauthnumber'
	echo '	print works of given author in TLG'
	echo 'pl phiauthnumber'
	echo '	print works of given author in PHI-5'
	echo 'tr tlgauthnumber worknumber'
	echo '	print text in TLG'
	echo 'pr phiauthnumber worknumber'
	echo '	print text in PHI'
	echo 'gs greekword'
	echo '	search greek word in LSJ'
	echo 'gl greekword'
	echo '	search inflections of given greek word'
	echo 'ls latinword'
	echo '	search latin word in L-S'
	echo 'll greekword'
	echo '	search inflections of given latin word'
	echo 'q: quit'
}

fn readauth{
	if (~ $1 PHI)
		/bin/lyceum/readauth -f $PHIROOT/authtab.dir
	if not
		/bin/lyceum/readauth -f $TLGROOT/authtab.dir
}

fn worklist{
	if (~ $1 PHI)
		/bin/lyceum/tlgviewer -f $PHIROOT/'lat'$2'.txt' -list
	if not
		/bin/lyceum/tlgviewer -f $TLGROOT/'tlg'$2'.txt' -list
}

fn readwork{
	if (~ $1 PHI)
		/bin/lyceum/tlgviewer -f $PHIROOT/'lat'$2'.txt' -w $3
	if not
		/bin/lyceum/tlgviewer -f $TLGROOT/'tlg'$2'.txt' -w $3
}

fn search{
	if (~ $1 LAT)
		/bin/lyceum/search -a $LAAN -idt $LAANIDT -dic $LS -dicidt $LSIDT -lat -w $2
	if not
		/bin/lyceum/search -a $GRAN -idt $GRANIDT -dic $LSJ -dicidt $LSJIDT -w $2
}

fn lemmata{
	if (~ $1 LAT)
		/bin/lyceum/lemmata -f $LALM -l -w $2
	if not
		/bin/lyceum/lemmata -f $GRLM -w $2
}

while() {
	echo -n '> '
	n=`{read}
	switch ($n(1)) {
	case l
		readauth $n(2)
	case tl
		worklist TLG $n(2)
	case pl
		worklist PHI $n(2)
	case tr
		readwork TLG $n(2) $n(3)
	case pr
		readwork PHI $n(2) $n(3)
	case gs
		search GRC $n(2)
	case ls
		search LAT $n(2)
	case gl
		lemmata GRC $n(2)
	case ll
		lemmata LAT $n(2)
	case q
		exit
	case *
		usage
	}
}
